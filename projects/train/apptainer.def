Bootstrap: docker
From: python:3.10.12-slim-bullseye
Stage: build

%files
# only copy precisely the files we need to keep things
# light and protect against any large files that might
# accidentally get created in this repo
. /opt/aframe/projects/train
../utils /opt/aframe/projects/utils
../../aframe /opt/aframe/aframe
../../pyproject.toml /opt/aframe/pyproject.toml
../../ml4gw /opt/aframe/ml4gw
~/.ssh /root/.ssh


%post
# install ssh and git for pip installs
# from directly from git directories
apt-get update
apt-get install -y --no-install-recommends \
    git \
    ssh
ssh-keyscan -t rsa github.com >> ~/.ssh/known_hosts
python -m pip install -e /opt/aframe/projects/train
